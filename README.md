# Hippopotamus Research — MarketBit

## מהי המערכת?
מערכת אוטומטית לזיהוי, עיבוד ופרסום כתבות כלכליות על תנועות חריגות במניות. המערכת כוללת סריקת חדשות, עיבוד טקסט עם LLM, הפקת HTML, ניהול מטא-דאטה, ולוגיקה של ניהול טיקרים — הכל בעברית, עם תמיכה מלאה ב-RTL, וללא תלות בממשק ניהול ידני.

---

## תוכן עניינים
1. [תיאור כללי](#תיאור-כללי)
2. [מבנה התיקיות והקבצים](#מבנה-התיקיות-והקבצים)
3. [התקנה והגדרות סביבת עבודה](#התקנה-והגדרות-סביבת-עבודה)
4. [שימוש — דוגמאות להרצה](#שימוש)
5. [פירוט תהליכים עיקריים](#פירוט-תהליכים-עיקריים)
6. [פתרון תקלות](#פתרון-תקלות)
7. [הרחבות, טיפים והערות](#הרחבות-וטיפים)
8. [רישיון](#רישיון)
9. [קישור לארכיון דפי מחקר](#קישור-לארכיון-דפי-מחקר)

---

## תיאור כללי

- **מטרת המערכת:**  
  לאתר תנועות חריגות במניות, להסביר אותן אוטומטית, ולפרסם כתבות ניתוח מקצועיות — ללא מגע יד אדם, מלבד ולידציה מינימלית.
- **שלבי העבודה:**  
  1. סריקת חדשות ממקורות (MarketBeat, Finviz, Briefing.com, Zacks ועוד)
  2. עיבוד טקסט עם LLM (מודל שפה גדול)
  3. הפקת HTML מעוצב
  4. ניהול מטא-דאטה, חיפוש, הצגה באתר

---

## מבנה התיקיות והקבצים

| קובץ/תיקיה                | תיאור |
|---------------------------|-------|
| `main.py`                 | תהליך באצ'י מלא — עיבוד כל הטיקרים |
| `run_single_ticker.py`    | עיבוד טיקר בודד (לבדיקות/פיתוח) |
| `scripts/`                | קוד עזר: תבניות HTML, עיבוד LLM, ניקוי טקסט |
| `articles/`               | כל כתבות ה-HTML שנוצרו |
| `txt/`                    | טקסטים מקוריים, מעובדים ומנוקים לכל טיקר |
| `data/`                   | מטא-דאטה (articles_metadata.json), קובץ CSV של טיקרים |
| `static/`                 | קבצי עיצוב, לוגו, אייקונים |
| `article_template.html`    | תבנית עיצוב לכתבות |
| `inject_js_cleaner.py`    | ניקוי קוד JS אוטומטי לכתבות |
| `processed_tickers/`      | לוגים של טיקרים שעובדו/לא זמינים |
| `requirements.txt`        | כל התלויות של המערכת |
| `README.md`               | קובץ זה |
| `LICENSE`                 | רישיון שימוש |

---

## התקנה והגדרות סביבת עבודה

1. **דרישות מוקדמות:**
   - Python 3.8 ומעלה
   - pip
   - Google Chrome מותקן
   - ChromeDriver תואם לגרסת הדפדפן (להורדה: https://chromedriver.chromium.org/downloads)

2. **התקנת תלויות:**
   ```bash
   pip install -r requirements.txt
   ```

3. **הגדרת קבצי נתונים:**
   - ודא ש־`data/flat-ui__data-*.csv` קיים (רשימת טיקרים).
   - ודא ש־`data/articles_metadata.json` קיים (אם לא — יווצר אוטומטית בהרצה).

---

## שימוש

### עיבוד טיקר בודד
```bash
python3 run_single_ticker.py AAPL
```
- יפיק כתבה חדשה ל־AAPL, כולל טקסטים, HTML ומטא-דאטה.

### עיבוד כל הטיקרים (באצ')
```bash
python3 main.py
```
- יעבור על כל הטיקרים בקובץ ה־CSV, יפיק כתבות חדשות, יעדכן מטא-דאטה, וינהל לוגים.

### הפעלת סביבה וירטואלית (מומלץ)
```bash
python3 -m venv venv
source venv/bin/activate
```

---

## פירוט תהליכים עיקריים

### 1. סריקת חדשות (Scraping)
- מתבצע עם Selenium, כולל טיפול בפופאפים.
- שומר טקסט מקורי ב־txt/[TICKER]_original_[DATE].txt

### 2. עיבוד טקסט (LLM)
- עיבוד עם מודל שפה (ראה scripts/llm_processor.py)
- שומר טקסט מעובד ב־txt/[TICKER]_processed_[DATE].txt

### 3. ניקוי טקסט
- המרה ל־HTML מסודר (convert_tagged_text_to_html)
- שומר ב־txt/[TICKER]_cleaned_[DATE].txt

### 4. הפקת כתבה
- שימוש ב־article_template.html
- שמירה ב־articles/[TICKER]_[DATE].html

### 5. ניהול מטא-דאטה
- עדכון data/articles_metadata.json עם כל כתבה חדשה

### 6. ניקוי קוד JS
- הפעלת inject_js_cleaner.py על כל כתבה חדשה

### 7. לוגים
- marketbit.log — לוג ראשי של כל התהליך
- processed_tickers/ — לוגים של טיקרים שעובדו/לא זמינים

---

## פתרון תקלות

- **Selenium לא מוצא דפדפן:**  
  ודא ש-Chrome מותקן, ועדכן את ChromeDriver.
- **שגיאת pip/תלויות:**  
  התקן מחדש עם `pip install -r requirements.txt`
- **טיקר לא מעובד:**  
  בדוק ב־processed_tickers/unavailable_tickers.json
- **קבצים חסרים:**  
  ודא שכל התיקיות (scripts, data, articles, txt, static) קיימות.
- **שגיאות בהרצת inject_js_cleaner.py:**  
  ודא שהקובץ קיים, ושהכתבה נוצרה כראוי.

---

## הרחבות וטיפים

- ניתן להוסיף/להסיר טיקרים ב־data/flat-ui__data-*.csv
- אפשר להרחיב את תבנית הכתבה ב־article_template.html
- כל קובץ bak, לוג ישן, או דיאגרמה — ניתן למחוק בבטחה
- מומלץ לבצע גיבוי לתיקיות articles/ ו־data/ לפני עדכון גרסה

---

## רישיון

כל הזכויות שמורות © 2024 Hippopotamus Research - Nir Elmaliah  
הקוד, התוכן והעיצוב בפרויקט זה הם קנייניים. אין להעתיק, להפיץ, לשנות, להשתמש או למסחר את הקוד או כל חלק ממנו, ללא אישור מפורש ובכתב מהיוצר.

## קישור לארכיון דפי מחקר

[לעיון בדפי מחקר היסטוריים (ארכיון)](https://thekinghippopotamus.github.io/marketBit_archives/)

בארכיון תוכל למצוא דפי מחקר ישנים שהוסרו מהמערכת הראשית, לצורך עיון היסטורי בלבד. הדפים מוצגים כפי שהיו בעת פרסומם.


